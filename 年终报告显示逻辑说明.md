# 年终报告 - 文字和标签显示逻辑说明

## 一、个性化开篇页

### 1. 标题
- **显示内容**：`@{{用户昵称}} 的{{年份}}体重蜕变报告`
- **显示条件**：始终显示
- **示例**：`@张三 的2025体重蜕变报告`

### 2. 副标题（三种情况）

#### 情况1：减重成功
- **显示内容**：`这一年，你用{{打卡天数}}天坚持，悄悄瘦了{{减重斤数}}斤～`
- **显示条件**：`stats.weightChange !== null && stats.weightChange < 0`
- **示例**：`这一年，你用76天坚持，悄悄瘦了6斤～`

#### 情况2：有打卡但未减重
- **显示内容**：`这一年，你坚持打卡{{打卡天数}}天，记录每一天的变化～`
- **显示条件**：`stats.totalDays > 0` 且不满足情况1
- **示例**：`这一年，你坚持打卡50天，记录每一天的变化～`

#### 情况3：无打卡记录
- **显示内容**：`记录每一天的变化`
- **显示条件**：`stats.totalDays === 0`
- **示例**：`记录每一天的变化`

---

## 二、个性标签（tags-container）

### 标签生成规则（可同时显示多个）

#### 1. 减重相关标签（按减重幅度分级）
- **`减重10斤+超级达人`**
  - 显示条件：`stats.weightChange < -10`（减重超过10斤）
  
- **`稳扎稳打减脂选手`**
  - 显示条件：`stats.weightChange < -5` 且 `>= -10`（减重5-10斤）
  
- **`自律减重达人`**
  - 显示条件：`stats.weightChange < 0` 且 `>= -5`（减重0-5斤）

- **`体重管理大师`**
  - 显示条件：`stats.weightChange === 0` 且 `stats.weightCount > 0`（体重保持稳定）

#### 2. 连续打卡标签（按连续天数分级）
- **`{{天数}}天连续打卡传奇`**（如：`65天连续打卡传奇`）
  - 显示条件：`stats.maxConsecutiveDays >= 60`
  
- **`{{天数}}天自律王者`**（如：`37天自律王者`）
  - 显示条件：`stats.maxConsecutiveDays >= 30` 且 `< 60`
  - 显示天数：实际连续打卡天数
  
- **`坚持打卡小能手`**
  - 显示条件：`stats.maxConsecutiveDays >= 15` 且 `< 30`

- **`一周坚持者`**
  - 显示条件：`stats.maxConsecutiveDays >= 7` 且 `< 15`

#### 3. 总打卡天数标签（按总天数分级）
- **`年度打卡超级劳模`**
  - 显示条件：`stats.totalDays >= 200`
  
- **`年度打卡劳模`**
  - 显示条件：`stats.totalDays >= 100` 且 `< 200`
  
- **`打卡积极分子`**
  - 显示条件：`stats.totalDays >= 50` 且 `< 100`

- **`月度打卡达人`**
  - 显示条件：`stats.totalDays >= 30` 且 `< 50`

#### 4. 数据质量标签（基于有体重数据的记录占比）
- **`数据记录完美主义者`**
  - 显示条件：`weightDataRatio >= 0.9` 且 `weightCount >= 20`（90%以上记录有体重数据，且至少20条）
  
- **`数据记录达人`**
  - 显示条件：`weightDataRatio >= 0.7` 且 `weightCount >= 10`（70%以上记录有体重数据，且至少10条）

#### 5. 月度表现标签（基于高光月份）
- **`月度逆袭之星`**
  - 显示条件：有高光月份且该月减重 `>= 10斤`
  
- **`月度突破者`**
  - 显示条件：有高光月份且该月减重 `>= 5斤` 且 `< 10斤`

#### 6. 打卡频率标签（基于平均每月打卡次数）
- **`月度全勤标兵`**
  - 显示条件：`monthlyAvgCount >= 25`（平均每月打卡25次以上）
  
- **`高频打卡者`**
  - 显示条件：`monthlyAvgCount >= 20` 且 `< 25`（平均每月打卡20-25次）

#### 7. 体重稳定性标签
- **`体重稳定大师`**
  - 显示条件：`weightChange >= -2` 且 `<= 2` 且 `weightCount >= 30`（体重变化在2斤以内，且有足够数据）

**整体显示条件**：`stats.personalityTags && stats.personalityTags.length > 0`

---

## 三、核心数据区解读

### 数据解读文字
- **显示内容**：`{{打卡天数}}天打卡 + {{最长连续天数}}天连续坚持，你的自律值直接拉满！`
- **显示条件**：`stats.maxConsecutiveDays > 0`
- **示例**：`76天打卡 + 37天连续坚持，你的自律值直接拉满！`

---

## 四、体重变化卡片

### 1. 体重变化数值
- **显示内容**：`变化：{{体重变化值}}斤`
- **显示条件**：`stats.weightChange !== null`
- **颜色规则**：
  - 绿色（`change-down`）：`stats.weightChange < 0`（减重）
  - 红色（`change-up`）：`stats.weightChange > 0`（增重）
  - 灰色（`change-same`）：`stats.weightChange === 0`（不变）

### 2. BMI关联信息
- **显示内容**：
  ```
  年初BMI：{{startBMI}}（{{startBMICategory}}）→ 年末BMI：{{endBMI}}（{{endBMICategory}}）
  ```
- **显示条件**：`stats.startBMI && stats.endBMI`（需要用户有身高数据）
- **BMI分类规则**：
  - `≤ 18.4`：偏瘦
  - `18.5 ~ 23.9`：正常
  - `24.0 ~ 27.9`：过重
  - `≥ 28.0`：肥胖
- **颜色规则**：
  - 绿色（`bmi-down`）：`stats.bmiChange < 0`（BMI下降）
  - 红色（`bmi-up`）：`stats.bmiChange > 0`（BMI上升）

---

## 五、体重极值卡片 - 高光月份解读

### 逆袭月解读
- **显示内容**：`{{月份}}月 = 你的「逆袭月」！本月瘦了{{减重斤数}}斤，这执行力太顶了～`
- **显示条件**：`stats.highlightMonth && stats.highlightMonthLoss`
- **识别规则**：自动找出月度减重最多的月份（`maxWeightLoss`）
- **示例**：`10月 = 你的「逆袭月」！本月瘦了11.7斤，这执行力太顶了～`

---

## 六、月度打卡统计

### 1. 月份标签

#### 逆袭月标签（`highlight-badge`）
- **显示内容**：`逆袭月`
- **显示条件**：`monthData.month === stats.highlightMonth`
- **样式**：金色背景（`#f39c12`）

#### 劳模月标签（`count-badge`）
- **显示内容**：`劳模月`
- **显示条件**：`monthData.month === stats.maxCountMonth && monthData.count >= 28`
- **样式**：绿色背景（`#27ae60`）

### 2. 月度减重信息
- **显示内容**：`本月瘦了{{weightLossText}}斤`
- **显示条件**：`monthData.weightLoss && monthData.weightLoss > 0`
- **示例**：`本月瘦了11.7斤`

### 3. 月份卡片高亮样式
- **逆袭月卡片**：金色渐变背景（`highlight-month-item`）
  - 条件：`monthData.month === stats.highlightMonth`
  
- **劳模月卡片**：绿色渐变背景（`max-count-month-item`）
  - 条件：`monthData.month === stats.maxCountMonth`

---

## 七、鼓励话语（encouragement-card）

### 鼓励文案（四种情况）

#### 情况1：大幅减重
- **显示内容**：`太棒了！你减重了{{减重斤数}}斤，继续保持！`
- **显示条件**：`stats.weightChange < -5`
- **示例**：`太棒了！你减重了8斤，继续保持！`

#### 情况2：小幅减重
- **显示内容**：`很好！你减重了{{减重斤数}}斤，继续加油！`
- **显示条件**：`stats.weightChange < 0` 且 `>= -5`
- **示例**：`很好！你减重了3斤，继续加油！`

#### 情况3：体重不变
- **显示内容**：`体重保持稳定，很棒！`
- **显示条件**：`stats.weightChange === 0`

#### 情况4：体重增加
- **显示内容**：`体重有所增加，注意饮食和运动哦！`
- **显示条件**：`stats.weightChange > 0`

#### 情况5：无数据
- **显示内容**：`继续坚持，记录每一天的变化！`
- **显示条件**：`stats.weightChange === null || stats.weightChange === undefined`

---

## 八、分享标题（onShareAppMessage）

### 分享文案（两种情况）

#### 情况1：有减重
- **显示内容**：`我今年瘦了{{减重斤数}}斤！你的体重报告也出炉啦～`
- **显示条件**：`stats.weightChange !== null && stats.weightChange < 0`
- **示例**：`我今年瘦了6斤！你的体重报告也出炉啦～`

#### 情况2：无减重或默认
- **显示内容**：`我的{{年份}}年瘦身打卡报告`
- **显示条件**：不满足情况1
- **示例**：`我的2025年瘦身打卡报告`

---

## 九、目标体重设置弹窗

### 显示内容
- **标题**：`设置2026年理想体重`
- **输入框**：`请输入理想体重（斤）`
- **需再减显示**：`需再减：{{targetWeightLoss}}斤`
  - 显示条件：`targetWeight && stats.endWeight`
  - 计算：`Math.max(0, stats.endWeight - targetWeight)`
- **进度条**：显示目标完成进度

---

## 十、数据统计说明

### 高光月份识别逻辑

#### 逆袭月（highlightMonth）
- **识别规则**：找出月度减重最多的月份
- **计算方式**：`maxWeightLoss = max(每月最大体重 - 每月最小体重)`
- **存储数据**：
  - `stats.highlightMonth`：月份（如：`2025-10`）
  - `stats.highlightMonthLoss`：该月减重斤数

#### 劳模月（maxCountMonth）
- **识别规则**：找出打卡次数最多的月份
- **计算方式**：`maxCount = max(每月打卡次数)`
- **存储数据**：
  - `stats.maxCountMonth`：月份（如：`2025-03`）
  - `stats.maxCount`：该月打卡次数

---

## 总结

### 始终显示的内容
1. 报告标题（带用户昵称）
2. 核心数据卡片（打卡天数、次数、最长连续）
3. 体重变化卡片（如果有体重数据）
4. 体重极值卡片（如果有体重数据）
5. 鼓励话语卡片
6. 行动按钮（设置目标体重、生成分享海报）

### 条件显示的内容
1. **个性标签**：根据减重、连续打卡、总打卡天数生成
2. **数据解读**：需要最长连续天数 > 0
3. **BMI信息**：需要用户有身高数据
4. **逆袭月解读**：需要识别出减重最多的月份
5. **月度标签**：逆袭月、劳模月标签
6. **月度减重**：该月有减重数据时显示

### 颜色规则
- **绿色**：减重、BMI下降、正向变化
- **红色**：增重、BMI上升、负向变化
- **灰色**：无变化
- **金色**：逆袭月相关
- **绿色渐变**：劳模月相关

